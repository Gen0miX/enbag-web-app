<div class="row" *ngIf="currentUser.role == '3'" id="client">
  <h1>Order</h1>
  <div class="row">
    <div class="col col-sm-4">
      <h2>Client</h2>
      <p>{{user.firstName}} {{user.lastName}}</p>
    </div>
    <div class="col col-sm-4">
      <h2>Installateur</h2>
      <p>{{installateur.firstName}} {{installateur.lastName}}</p>
      <h2>E-mail</h2>
      <p>{{installateur.email}}</p>
      <h2>Phone number</h2>
      <p>0{{installateur.phoneNumber}}</p>
    </div>
    <div class="col col-sm-4">
      <h2>Status</h2>
      <p>{{order.status}}</p>
    </div>
  </div>
  <div class="row">
    <h2>Location</h2>
    <div class="col col-sm-4">
      <h3>Name</h3>
      <p>{{orderLocation.name}}</p>
      <h3>Address</h3>
      <p>{{orderLocation.address}}</p>
    </div>
    <div class="col col-sm-4">
      <h3>City</h3>
      <p>{{orderLocation.city}}</p>
      <h3>Post code</h3>
      <p>{{orderLocation.postCode}}</p>
    </div>
  </div>
  <div class="row">
    <app-date-time [dateTimes]="order.datesTimesToPick" *ngIf="order.datesTimesToPick != undefined"></app-date-time>
    <div class="container" *ngIf="order.status=='first appointment set'">
      <h2>Date - time of the first meeting</h2>
      <p>{{order.dateTimePicked.date}} : {{order.dateTimePicked.times[0].startTime}} -
        {{order.dateTimePicked.times[0].endTime}}</p>
    </div>
    <div class="container" *ngIf="order.status=='second appointment set'">
      <h2>Date - time of the second meeting</h2>
      <p>{{order.dateTimePicked.date}} : {{order.dateTimePicked.times[0].startTime}} -
        {{order.dateTimePicked.times[0].endTime}}</p>
    </div>
  </div>

  <app-make-payment *ngIf="order.status == 'waiting for payment'" [order]="order"></app-make-payment>
</div>

<div class="row" *ngIf="currentUser.role == '2'">
  <h1>Order - {{user.firstName}} {{user.lastName}}</h1>
  <div class="row">
    <div class="col col-sm-4">
      <h2>Client</h2>
      <p>{{user.firstName}} {{user.lastName}}</p>
      <h2>E-mail</h2>
      <p>{{user.email}}</p>
      <h2>Phone number</h2>
      <p>0{{user.phoneNumber}}</p>
    </div>
    <div class="col col-sm-4">
      <h2>Parking spot number</h2>
      <p>{{order.spotNR}}</p>
      <h2>Status</h2>
      <p>{{order.status}}</p>
    </div>
  </div>
  <div class="row container-fluid" *ngIf="order.status == 'new'">
    <form [formGroup]="dateTimeForm" (ngSubmit)="onDateSubmit()">
      <div class="col col-sm-4">
        <mat-form-field >
          <mat-label>Date / Time</mat-label>
          <mat-select formControlName="dateTimes" id="dateTimes">
            <mat-optgroup *ngFor="let date of order.datesTimesToPick" [label]="date.date" >
              <mat-option *ngFor="let time of date.times; let i = index" (onSelectionChange)="optionSelected($event)" [value]="date.times[i]" >
                {{time.startTime}} - {{time.endTime}}
              </mat-option>
            </mat-optgroup>
          </mat-select>
        </mat-form-field>
      </div>
      <div class="col">
        <button mat-flat-button color="primary" type="submit">Confirm date</button>
      </div>
    </form>
  </div>
<div *ngIf="order.status == 'first appointment set'">
  <form [formGroup]="dateForm" (ngSubmit)="sendDateForSecondAppointment()">
    <div class="form-group">
      <mat-form-field appearance="fill">
        <mat-label>Choose a date</mat-label>
        <input matInput [matDatepicker]="picker" [matDatepickerFilter]="filters" [errorStateMatcher]="matcher" formControlName="date">
        <mat-error *ngIf="dateForm.controls['date'].hasError('required')">
          A date is <strong>required</strong>
        </mat-error>
        <mat-datepicker-toggle matSuffix [for]="picker"></mat-datepicker-toggle>
        <mat-datepicker #picker></mat-datepicker>
      </mat-form-field>
      <mat-selection-list #timesSelected
                          [multiple]="false"
                          formControlName="time">
        <mat-list-option *ngFor="let time of times" [value]="time"
                         style="display:inline-block; width:50%;">
          <p matLine>{{time.startTime}} <br>
            {{time.endTime}}</p>
        </mat-list-option>
        <mat-error *ngIf="dateForm.controls['time'].hasError('required') && isSubmitted">
          A time is <strong>required</strong>
        </mat-error>
      </mat-selection-list>
    </div>
    <button mat-flat-button color="primary" type="submit">
      Confirm date for second appointment
    </button>
  </form>
</div>
  <button mat-flat-button color="primary" *ngIf="order.status == 'second appointment set'"
          (click)="setPaymentStatus()">Installation complete</button>
</div>
